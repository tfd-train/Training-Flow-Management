<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ºåŒ—å¸‚æ¶ˆé˜²å±€ 114å¹´æ•™è‚²è¨“ç·´ç®¡ç†ç³»çµ±</title>
    <style>
        /* --- åŸºç¤æ¨£å¼ (æ¨¡æ“¬ Excel é¢¨æ ¼) --- */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; color: #333; }
        
        /* é ‚éƒ¨å·¥å…·åˆ— */
        .header { background: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .title h1 { margin: 0; font-size: 20px; color: #1e3a8a; }
        .title p { margin: 5px 0 0; font-size: 12px; color: #666; }
        
        .btn-group button { padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer; font-size: 13px; margin-left: 5px; color: white; }
        .btn-excel { background-color: #16a34a; }
        .btn-pdf { background-color: #dc2626; }
        .btn-save { background-color: #2563eb; }
        .btn-add { background: none; border: none; color: #2563eb; cursor: pointer; font-weight: bold; padding: 10px; width: 100%; text-align: left; }
        .btn-add:hover { background-color: #eff6ff; }

        /* åˆ†é ç±¤ (Tabs) */
        .tabs { display: flex; margin-bottom: 0; padding-left: 10px; border-bottom: 1px solid #ccc; }
        .tab { padding: 10px 20px; cursor: pointer; background: #e5e7eb; border: 1px solid transparent; border-bottom: none; margin-right: 2px; border-radius: 6px 6px 0 0; font-size: 14px; color: #666; }
        .tab.active { background: white; border-color: #ccc; border-bottom-color: white; color: #1d4ed8; font-weight: bold; }

        /* è¡¨æ ¼å€åŸŸ */
        .content-area { background: white; border: 1px solid #ccc; min-height: 600px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 13px; min-width: 1200px; table-layout: fixed; }
        
        th { background-color: #f3f4f6; border: 1px solid #d1d5db; padding: 8px; text-align: left; font-weight: 600; color: #374151; position: sticky; top: 0; z-index: 10; }
        td { border: 1px solid #d1d5db; padding: 0; height: 32px; position: relative; }
        
        /* è¼¸å…¥æ¡†æ¨£å¼ */
        input[type="text"], input[type="number"] { width: 100%; height: 100%; border: none; outline: none; padding: 4px 8px; box-sizing: border-box; font-family: inherit; font-size: 13px; background: transparent; }
        input:focus { background-color: #eff6ff; }
        input::placeholder { color: #d1d5db; }

        /* ç‰¹æ®Šæ¬„ä½é¡è‰² */
        .bg-calc { background-color: #f9fafb; text-align: center; color: #666; line-height: 32px; } /* è‡ªå‹•è¨ˆç®—å”¯è®€ */
        .bg-blue-tint { background-color: #eff6ff; }
        .text-blue { color: #1e40af; font-weight: bold; }
        .bg-orange-tint { background-color: #fff7ed; }
        .text-orange { color: #9a3412; font-weight: bold; }
        .bg-red-tint { background-color: #fef2f2; }
        .text-red { color: #b91c1c; font-weight: bold; }

        /* ç”˜ç‰¹åœ–çŸ©é™£æ¨£å¼ */
        .matrix-cell input { text-align: center; }
        .matrix-header-day { width: 30px; text-align: center; font-size: 11px; color: #666; padding: 2px; }
        .alert-row td { background-color: #1f2937; color: white; text-align: center; font-weight: bold; border-color: #374151; }
        .alert-cell-red { background-color: #dc2626 !important; color: white; animation: pulse 2s infinite; }
        .alert-cell-yellow { background-color: #d97706 !important; color: white; }
        
        .delete-btn { color: #9ca3af; cursor: pointer; text-align: center; width: 100%; border: none; background: none; }
        .delete-btn:hover { color: #dc2626; }
        
        /* éš±è—é‚è¼¯ */
        .page { display: none; }
        .page.active { display: block; }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.8; } 100% { opacity: 1; } }
    </style>
</head>
<body>

    <!-- é ‚éƒ¨ -->
    <div class="header">
        <div class="title">
            <h1>è‡ºåŒ—å¸‚æ”¿åºœæ¶ˆé˜²å±€ 114å¹´æ•™è‚²è¨“ç·´ç®¡ç†ç³»çµ±</h1>
            <p>åˆ¶å¼è¡¨æ ¼å¡«å ±ãƒ»è‡ªå‹•æµè·¯åˆ†æ (HTML ç¨ç«‹ç‰ˆ)</p>
        </div>
        <div class="btn-group">
            <button class="btn-excel" onclick="alert('å·²åŒ¯å‡º Excel (æ¨¡æ“¬)')">ğŸ“¥ ä¸‹è¼‰ Excel</button>
            <button class="btn-pdf" onclick="alert('å·²åŒ¯å‡º PDF (æ¨¡æ“¬)')">ğŸ“„ ä¸‹è¼‰ PDF</button>
            <button class="btn-save" onclick="saveData()">ğŸ’¾ å„²å­˜è³‡æ–™</button>
        </div>
    </div>

    <!-- åˆ†é ç±¤ -->
    <div class="tabs">
        <div class="tab active" onclick="switchTab(1)">é™„ä»¶1-æ¶ˆé˜²äººå“¡</div>
        <div class="tab" onclick="switchTab(2)">é™„ä»¶2-éæ¶ˆé˜²äººå“¡</div>
        <div class="tab" onclick="switchTab(3)">é™„ä»¶3-é‡å¤§æ´»å‹•</div>
        <div class="tab" onclick="switchTab(4)">ç”˜ç‰¹åœ–-è¨“ç·´æµè·¯</div>
    </div>

    <!-- å…§å®¹å€ -->
    <div class="content-area">
        
        <!-- åˆ†é  1: æ¶ˆé˜²äººå“¡ -->
        <div id="page1" class="page active">
            <table>
                <thead>
                    <tr>
                        <th style="width:40px">åˆª</th>
                        <th style="width:50px">æœˆ</th>
                        <th style="width:100px">æ‰¿è¾¦å–®ä½</th>
                        <th>èª²ç¨‹åç¨±</th>
                        <th style="width:100px">å°è±¡</th>
                        <th style="width:120px">æ—¥æœŸ (1/6-19)</th>
                        <th style="width:120px">åœ°é»</th>
                        <th style="width:50px">æ¢¯æ•¸</th>
                        <th style="width:50px">äººæ•¸</th>
                        <th style="width:60px">åˆè¨ˆ</th>
                        <th style="width:60px">æ™‚æ•¸</th>
                        <th style="width:80px" class="bg-blue-tint">èª¿ç”¨</th>
                        <th>å‚™è¨»</th>
                    </tr>
                </thead>
                <tbody id="tbody1"></tbody>
            </table>
            <button class="btn-add" onclick="addRow(1)">+ æ–°å¢èª²ç¨‹</button>
        </div>

        <!-- åˆ†é  2: éæ¶ˆé˜²äººå“¡ -->
        <div id="page2" class="page">
            <table>
                <thead>
                    <tr>
                        <th style="width:40px">åˆª</th>
                        <th style="width:50px">æœˆ</th>
                        <th style="width:100px">æ‰¿è¾¦å–®ä½</th>
                        <th>èª²ç¨‹åç¨±</th>
                        <th style="width:100px">å°è±¡</th>
                        <th style="width:120px">æ—¥æœŸ</th>
                        <th style="width:120px">åœ°é»</th>
                        <th style="width:50px">æ¢¯æ•¸</th>
                        <th style="width:50px">äººæ•¸</th>
                        <th style="width:60px">åˆè¨ˆ</th>
                        <th style="width:60px">æ™‚æ•¸</th>
                        <th style="width:80px" class="bg-orange-tint">æ•™å®˜</th>
                        <th>å‚™è¨»</th>
                    </tr>
                </thead>
                <tbody id="tbody2"></tbody>
            </table>
            <button class="btn-add" onclick="addRow(2)">+ æ–°å¢éæ¶ˆé˜²èª²ç¨‹</button>
        </div>

        <!-- åˆ†é  3: é‡å¤§æ´»å‹• -->
        <div id="page3" class="page">
            <table>
                <thead>
                    <tr>
                        <th style="width:40px">åˆª</th>
                        <th style="width:100px">æ‰¿è¾¦å–®ä½</th>
                        <th>é‡å¤§æ´»å‹•åç¨±</th>
                        <th style="width:150px">å°è±¡</th>
                        <th style="width:120px">æ—¥æœŸ (1/16)</th>
                        <th style="width:60px">å¤©æ•¸</th>
                        <th style="width:60px">æ™‚æ•¸</th>
                        <th style="width:100px" class="bg-red-tint">æ¯æ—¥èª¿ç”¨</th>
                        <th style="width:150px">åœ°é»</th>
                    </tr>
                </thead>
                <tbody id="tbody3"></tbody>
            </table>
            <button class="btn-add" onclick="addRow(3)">+ æ–°å¢é‡å¤§æ´»å‹•</button>
        </div>

        <!-- åˆ†é  4: ç”˜ç‰¹åœ– -->
        <div id="page4" class="page">
            <div style="padding:10px; background:#fffbeb; color:#92400e; border-bottom:1px solid #fcd34d; font-size:12px;">
                âš ï¸ <strong>è‡ªå‹•æ¨¡å¼ï¼š</strong> æ­¤è¡¨ç”±é™„ä»¶1-3è‡ªå‹•ç”Ÿæˆã€‚æ‚¨å¯ç›´æ¥é»æ“Šæ ¼å­ä¿®æ”¹æ•¸å­—ã€‚è‹¥å–®æ—¥ç¼ºå£ >100 æœƒäº®ç´…ç‡ˆã€‚
            </div>
            <table>
                <thead>
                    <tr id="ganttHeader">
                        <th style="width:50px">æœˆ</th>
                        <th style="width:250px">æ´»å‹•åç¨± (è‡ªå‹•å½™æ•´)</th>
                        <!-- JS å°‡è‡ªå‹•ç”¢ç”Ÿ 1-31 çš„æ¨™é¡Œ -->
                    </tr>
                </thead>
                <tbody id="tbody4"></tbody>
                <tfoot id="tfoot4"></tfoot>
            </table>
        </div>
    </div>

    <!-- è…³æœ¬é‚è¼¯ (JavaScript) -->
    <script>
        // --- åˆå§‹è³‡æ–™ (æ¨¡æ“¬æ‚¨çš„ Excel) ---
        let dataSheet1 = [
            { id: 1, month: '1', unit: 'è¨“ç·´ä¸­å¿ƒ', name: 'ç«ç½æ¶æ•‘åˆç´šç­', target: 'æ¶ˆé˜²äººå“¡', date: '1/6-19', location: 'ç«¹å±±è¨“ç·´ä¸­å¿ƒ', batches: 1, perBatch: 20, hours: 80, manpower: 20, note: '' },
            { id: 2, month: '1', unit: 'è¨“ç·´ä¸­å¿ƒ', name: '112å¹´è­¦ç‰¹ä¸€èˆ¬ç”Ÿ', target: 'æ¶ˆé˜²äººå“¡', date: '1/10-1/24', location: 'è¨“ç·´ä¸­å¿ƒ', batches: 1, perBatch: 4, hours: 8, manpower: 4, note: '' },
            { id: 3, month: '2', unit: 'è¨“ç·´ä¸­å¿ƒ', name: 'æ•‘åŠ©è¨“ç¬¬36æœŸ', target: 'æ¶ˆé˜²äººå“¡', date: '2/10-4/18', location: 'è¨“ç·´ä¸­å¿ƒ', batches: 1, perBatch: 42, hours: 320, manpower: 43, note: 'å«æ•™å®˜' }
        ];
        let dataSheet2 = [
            { id: 1, month: '1', unit: 'æ‡‰è®Šç§‘', name: 'é˜²ç½æ¥­å‹™ç ”ç¿’ç­', target: 'å„æ©Ÿé—œ', date: '1/13-1/15', location: 'å…¬è¨“è™•', batches: 3, perBatch: 96, hours: 18, instructor: 0, note: '' },
            { id: 2, month: '1', unit: 'æ¶æ•‘ç§‘', name: 'ç¾©æ¶ˆæœæ•‘éšŠè¨“ç·´', target: 'ç¾©æ¶ˆ', date: '1/18', location: 'è¨“ç·´ä¸­å¿ƒ', batches: 1, perBatch: 41, hours: 6, instructor: 0, note: '' }
        ];
        let dataSheet3 = [
            { id: 1, unit: 'ç§˜æ›¸å®¤', name: '119æ¶ˆé˜²ç¯€å¤§æœƒ', target: 'æˆçäººå“¡', date: '1/16', days: 3, hours: 3, manpower: 25, location: 'ä¸­æ²¹å¤§æ¨“' },
            { id: 2, unit: 'æ‡‰è®Šç§‘', name: 'æ°‘å®‰11è™Ÿæ¼”ç¿’', target: 'å¤–å‹¤å¤§éšŠ', date: '7/15', days: 1, hours: 24, manpower: 400, location: 'å¾…å®š' }
        ];
        
        // å­˜æ”¾ç”˜ç‰¹åœ–è³‡æ–™
        let ganttData = []; 

        // --- æ¸²æŸ“å‡½å¼ ---
        function renderTables() {
            renderSheet1();
            renderSheet2();
            renderSheet3();
            // ç”˜ç‰¹åœ–æ¡ lazy renderï¼Œåˆ‡æ›æ™‚æ‰è¨ˆç®—
        }

        function renderSheet1() {
            const tbody = document.getElementById('tbody1');
            tbody.innerHTML = '';
            dataSheet1.forEach((row, index) => {
                const total = (row.batches || 0) * (row.perBatch || 0);
                tbody.innerHTML += `
                    <tr>
                        <td><button class="delete-btn" onclick="delRow(1, ${index})">ğŸ—‘ï¸</button></td>
                        <td><input type="text" value="${row.month}" onchange="updateData(1, ${index}, 'month', this.value)"></td>
                        <td><input type="text" value="${row.unit}" onchange="updateData(1, ${index}, 'unit', this.value)" placeholder="å–®ä½"></td>
                        <td><input type="text" value="${row.name}" onchange="updateData(1, ${index}, 'name', this.value)" placeholder="èª²ç¨‹"></td>
                        <td><input type="text" value="${row.target}" onchange="updateData(1, ${index}, 'target', this.value)"></td>
                        <td><input type="text" value="${row.date}" onchange="updateData(1, ${index}, 'date', this.value)" placeholder="1/6-19"></td>
                        <td><input type="text" value="${row.location}" onchange="updateData(1, ${index}, 'location', this.value)"></td>
                        <td><input type="number" value="${row.batches}" onchange="updateData(1, ${index}, 'batches', this.value)"></td>
                        <td><input type="number" value="${row.perBatch}" onchange="updateData(1, ${index}, 'perBatch', this.value)"></td>
                        <td class="bg-calc">${total}</td>
                        <td><input type="number" value="${row.hours}" onchange="updateData(1, ${index}, 'hours', this.value)"></td>
                        <td class="bg-blue-tint"><input type="number" class="text-blue" value="${row.manpower}" onchange="updateData(1, ${index}, 'manpower', this.value)"></td>
                        <td><input type="text" value="${row.note}" onchange="updateData(1, ${index}, 'note', this.value)"></td>
                    </tr>
                `;
            });
        }

        function renderSheet2() {
            const tbody = document.getElementById('tbody2');
            tbody.innerHTML = '';
            dataSheet2.forEach((row, index) => {
                const total = (row.batches || 0) * (row.perBatch || 0);
                tbody.innerHTML += `
                    <tr>
                        <td><button class="delete-btn" onclick="delRow(2, ${index})">ğŸ—‘ï¸</button></td>
                        <td><input type="text" value="${row.month}" onchange="updateData(2, ${index}, 'month', this.value)"></td>
                        <td><input type="text" value="${row.unit}" onchange="updateData(2, ${index}, 'unit', this.value)"></td>
                        <td><input type="text" value="${row.name}" onchange="updateData(2, ${index}, 'name', this.value)"></td>
                        <td><input type="text" value="${row.target}" onchange="updateData(2, ${index}, 'target', this.value)"></td>
                        <td><input type="text" value="${row.date}" onchange="updateData(2, ${index}, 'date', this.value)"></td>
                        <td><input type="text" value="${row.location}" onchange="updateData(2, ${index}, 'location', this.value)"></td>
                        <td><input type="number" value="${row.batches}" onchange="updateData(2, ${index}, 'batches', this.value)"></td>
                        <td><input type="number" value="${row.perBatch}" onchange="updateData(2, ${index}, 'perBatch', this.value)"></td>
                        <td class="bg-calc">${total}</td>
                        <td><input type="number" value="${row.hours}" onchange="updateData(2, ${index}, 'hours', this.value)"></td>
                        <td class="bg-orange-tint"><input type="number" class="text-orange" value="${row.instructor}" onchange="updateData(2, ${index}, 'instructor', this.value)"></td>
                        <td><input type="text" value="${row.note}" onchange="updateData(2, ${index}, 'note', this.value)"></td>
                    </tr>
                `;
            });
        }

        function renderSheet3() {
            const tbody = document.getElementById('tbody3');
            tbody.innerHTML = '';
            dataSheet3.forEach((row, index) => {
                tbody.innerHTML += `
                    <tr>
                        <td><button class="delete-btn" onclick="delRow(3, ${index})">ğŸ—‘ï¸</button></td>
                        <td><input type="text" value="${row.unit}" onchange="updateData(3, ${index}, 'unit', this.value)"></td>
                        <td><input type="text" value="${row.name}" onchange="updateData(3, ${index}, 'name', this.value)"></td>
                        <td><input type="text" value="${row.target}" onchange="updateData(3, ${index}, 'target', this.value)"></td>
                        <td><input type="text" value="${row.date}" onchange="updateData(3, ${index}, 'date', this.value)"></td>
                        <td><input type="number" value="${row.days}" onchange="updateData(3, ${index}, 'days', this.value)"></td>
                        <td><input type="number" value="${row.hours}" onchange="updateData(3, ${index}, 'hours', this.value)"></td>
                        <td class="bg-red-tint"><input type="number" class="text-red" value="${row.manpower}" onchange="updateData(3, ${index}, 'manpower', this.value)"></td>
                        <td><input type="text" value="${row.location}" onchange="updateData(3, ${index}, 'location', this.value)"></td>
                    </tr>
                `;
            });
        }

        // --- è³‡æ–™æ›´æ–°é‚è¼¯ ---
        function updateData(sheetType, index, field, value) {
            if(sheetType === 1) { dataSheet1[index][field] = value; renderSheet1(); }
            if(sheetType === 2) { dataSheet2[index][field] = value; renderSheet2(); }
            if(sheetType === 3) { dataSheet3[index][field] = value; renderSheet3(); }
        }

        function addRow(sheetType) {
            if(sheetType === 1) dataSheet1.push({ month: '', unit: '', name: '', date: '', manpower: '' });
            if(sheetType === 2) dataSheet2.push({ month: '', unit: '', name: '', date: '', instructor: '' });
            if(sheetType === 3) dataSheet3.push({ unit: '', name: '', date: '', manpower: '' });
            renderTables();
        }

        function delRow(sheetType, index) {
            if(!confirm('ç¢ºå®šåˆªé™¤æ­¤åˆ—ï¼Ÿ')) return;
            if(sheetType === 1) dataSheet1.splice(index, 1);
            if(sheetType === 2) dataSheet2.splice(index, 1);
            if(sheetType === 3) dataSheet3.splice(index, 1);
            renderTables();
        }

        function saveData() {
            console.log({ dataSheet1, dataSheet2, dataSheet3 });
            alert('è³‡æ–™å·²æš«å­˜ (å¯¦éš›é–‹ç™¼éœ€é€£æ¥è³‡æ–™åº«)');
        }

        // --- ç”˜ç‰¹åœ–æ ¸å¿ƒé‚è¼¯ ---
        function switchTab(tabId) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab')[tabId-1].classList.add('active');
            document.getElementById(`page${tabId}`).classList.add('active');
            
            if(tabId === 4) calculateAndRenderGantt();
        }

        function parseDateToDays(dateStr) {
            const days = [];
            if (!dateStr) return days;
            try {
                const clean = dateStr.replace(/\(.*\)/, '').trim();
                const full = clean.match(/(\d+)\/(\d+)-(\d+)\/(\d+)/);
                const range = clean.match(/(\d+)\/(\d+)-(\d+)/);
                const single = clean.match(/(\d+)\/(\d+)/);

                if (full && full[1] === full[3]) { for(let i=parseInt(full[2]); i<=parseInt(full[4]); i++) days.push(i); }
                else if (range) { for(let i=parseInt(range[2]); i<=parseInt(range[3]); i++) days.push(i); }
                else if (single) { days.push(parseInt(single[2])); }
            } catch(e){}
            return days;
        }

        function calculateAndRenderGantt() {
            // 1. åˆå§‹åŒ–è¡¨é ­
            const headerRow = document.getElementById('ganttHeader');
            headerRow.innerHTML = '<th style="width:50px">æœˆ</th><th style="width:250px">ç­æœŸ/æ´»å‹•åç¨±</th>';
            for(let i=1; i<=31; i++) {
                headerRow.innerHTML += `<th class="matrix-header-day">${i}</th>`;
            }

            // 2. å½™æ•´è³‡æ–™
            ganttData = [];
            
            // è™•ç†è¡¨1
            dataSheet1.forEach(item => {
                if(item.date && item.manpower) {
                    let rowDays = Array(31).fill('');
                    parseDateToDays(item.date).forEach(d => { if(d<=31) rowDays[d-1] = item.manpower; });
                    ganttData.push({ month: item.month||'1', name: item.name + ` (èª¿ç”¨${item.manpower}äºº)`, days: rowDays, type: 's1' });
                }
            });
            // è™•ç†è¡¨2 (åƒ…æ•™å®˜)
            dataSheet2.forEach(item => {
                if(item.date && item.instructor > 0) {
                    let rowDays = Array(31).fill('');
                    parseDateToDays(item.date).forEach(d => { if(d<=31) rowDays[d-1] = item.instructor; });
                    ganttData.push({ month: item.month||'1', name: item.name + ` (æ•™å®˜${item.instructor}äºº)`, days: rowDays, type: 's2' });
                }
            });
            // è™•ç†è¡¨3
            dataSheet3.forEach(item => {
                if(item.date && item.manpower) {
                    let rowDays = Array(31).fill('');
                    parseDateToDays(item.date).forEach(d => { if(d<=31) rowDays[d-1] = item.manpower; });
                    let m = item.date.match(/(\d+)\//);
                    ganttData.push({ month: m?m[1]:'1', name: `[é‡å¤§] ${item.name} (èª¿ç”¨${item.manpower}äºº)`, days: rowDays, type: 's3' });
                }
            });

            // æ’åº
            ganttData.sort((a,b) => parseInt(a.month) - parseInt(b.month));

            // 3. æ¸²æŸ“è¡¨æ ¼
            const tbody = document.getElementById('tbody4');
            tbody.innerHTML = '';
            
            if(ganttData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="33" style="text-align:center; padding:20px; color:#999;">å°šç„¡è³‡æ–™ï¼Œè«‹å…ˆè‡³åˆ†é 1-3å¡«å¯«</td></tr>';
            } else {
                ganttData.forEach((row, rIdx) => {
                    let html = `<tr>
                        <td style="text-align:center; font-weight:bold; background:#f9fafb;">${row.month}æœˆ</td>
                        <td style="font-size:12px; padding:0 5px; color:#333;">${row.name}</td>`;
                    
                    row.days.forEach((val, cIdx) => {
                        const bg = val ? 'white' : '#f9fafb';
                        const font = val ? 'bold' : 'normal';
                        html += `<td style="background:${bg}" class="matrix-cell">
                            <input type="text" value="${val}" style="font-weight:${font}" 
                             onchange="ganttData[${rIdx}].days[${cIdx}]=this.value; renderGanttFooter();">
                        </td>`;
                    });
                    html += '</tr>';
                    tbody.innerHTML += html;
                });
            }
            renderGanttFooter();
        }

        function renderGanttFooter() {
            const tfoot = document.getElementById('tfoot4');
            let sums = Array(31).fill(0);

            ganttData.forEach(row => {
                row.days.forEach((val, idx) => {
                    sums[idx] += (parseInt(val) || 0);
                });
            });

            let html = '<tr class="alert-row"><td colspan="2" style="text-align:right; padding-right:10px;">æ¯æ—¥äººåŠ›ç¼ºå£åˆè¨ˆ</td>';
            sums.forEach(sum => {
                let cls = '';
                if(sum > 100) cls = 'alert-cell-red';
                else if(sum > 50) cls = 'alert-cell-yellow';
                html += `<td class="${cls}">${sum > 0 ? sum : ''}</td>`;
            });
            html += '</tr>';
            tfoot.innerHTML = html;
        }

        // åˆå§‹åŒ–
        renderTables();

    </script>
</body>
</html>
